import{j as e,B as n,S as R,A as P,a2 as $,ai as y,I as O,aZ as V,bt as w,a3 as z,C as A,G as v,h as d,Q as q,W as G,D as _}from"./mui-vendor-DlldRxor.js";import{a as h,b as I}from"./react-vendor-C0s_J9t-.js";import{i as N,I as L,j as S,V as Y,u as Z,z as H,A as K,Y as Q,Z as J,_ as X}from"./index-D4QRAU_W.js";import{P as ee,a as F}from"./ProductTableToolbar-5drI2qdY.js";import{D as te}from"./DataTable-CqcHOsap.js";import{F as se}from"./FormattedCurrency-CWfs6hb7.js";import{V as ae,a as re}from"./ActionButtons-BOIGwPW5.js";import{M as ne}from"./MobileAppShell-dHUJWRrR.js";import"./redux-vendor-tKFe_QvA.js";import"./firebase-vendor-40dJGoDN.js";import"./utils-vendor-CFocuF-S.js";import"./pdf-vendor-DisdNAgy.js";const U=({products:p,onEdit:l,onFilterChange:f,onBulkCategoryUpdate:m})=>{const x=N(),[c,o]=h.useState([]),[a,b]=h.useState({}),[j,u]=h.useState(!1),[r,g]=h.useState("");h.useEffect(()=>{x(L())},[x]);const C=S(Y),B=t=>{b(t),f(t)},D=t=>{o(s=>s.includes(t)?s.filter(i=>i!==t):[...s,t])},E=async(t,s)=>{if(m)try{await m(t,s),o([]);const i=M(s);g(`Successfully assigned ${t.length} product(s) to category "${i}"`),u(!0)}catch{g("Failed to assign category to products"),u(!0)}},k=()=>{u(!1)},M=t=>{if(!t||!Array.isArray(C))return"-";const s=C.find(i=>i.id===t);return s?s.name:"-"},T=[{id:"select",label:"",format:(t,s)=>s?e.jsx($,{checked:c.includes(s.sku),onChange:()=>D(s.sku)}):null},{id:"sku",label:"SKU",filter:!0},{id:"name",label:"Name",filter:!0},{id:"categoryId",label:"Category",format:()=>e.jsx(y,{label:"No Category",color:"warning",size:"small"})},{id:"platform",label:"Platform",format:t=>{const s=t;return e.jsx(y,{label:s.toUpperCase(),color:t==="amazon"?"default":"primary"})},filter:!0},{id:"sellingPrice",label:"Selling Price",align:"right",format:t=>e.jsx(se,{value:t})},{id:"actions",label:"Actions",align:"center",format:(t,s)=>W(s)}],W=t=>{var s,i;return e.jsxs(e.Fragment,{children:[e.jsx(O,{size:"small","aria-label":`edit-${t.sku}`,onClick:()=>l(t),children:e.jsx(V,{})}),((s=t.metadata)==null?void 0:s.flipkartSerialNumber)&&e.jsx(ae,{flipkartSerialNumber:t.metadata.flipkartSerialNumber}),((i=t.metadata)==null?void 0:i.amazonSerialNumber)&&e.jsx(re,{amazonSerialNumber:t.metadata.amazonSerialNumber})]})};return e.jsxs(n,{sx:{width:"100%"},children:[e.jsx(ee,{platform:a.platform,search:a.search,selectedProducts:c,categories:C,allProducts:p,onFilterChange:B,onBulkCategoryUpdate:E}),e.jsx(te,{columns:T,data:p,defaultSortColumn:"sku",defaultSortDirection:"asc",rowsPerPageOptions:[10,25,50],defaultRowsPerPage:10}),e.jsx(R,{open:j,autoHideDuration:6e3,onClose:k,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(P,{onClose:k,severity:"success",sx:{width:"100%"},children:r})})]})},be=()=>{const p=Z(),l=N(),{items:f,loading:m}=S(r=>r.products),x=S(H),[c,o]=I.useState(null),a=I.useMemo(()=>f.filter(r=>!r.categoryId||r.categoryId.trim()===""),[f]);h.useEffect(()=>{x&&l(K({}))},[l,x]);const b=async(r,g)=>{try{await l(X({sku:r,data:g})).unwrap(),o(null)}catch{}},j=async(r,g)=>{try{await l(Q({skus:r,data:{categoryId:g}})).unwrap()}catch{}},u=r=>{l(J(r))};return p?e.jsx(ne,{pageTitle:"Uncategorized",children:e.jsxs(n,{sx:{p:2},children:[a.length>0&&e.jsx(n,{sx:{mb:2,display:"flex",justifyContent:"center"},children:e.jsx(y,{label:`${a.length} Products`,color:"warning",size:"medium"})}),a.length>0&&e.jsxs(P,{severity:"warning",sx:{mb:2},children:[e.jsx(w,{children:"Action Required"}),a.length," product(s) need categories."]}),e.jsx(z,{sx:{p:2},children:m?e.jsx(n,{display:"flex",justifyContent:"center",py:4,children:e.jsx(A,{color:"warning",size:40})}):a.length===0?e.jsxs(n,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:6,children:[e.jsx(v,{sx:{fontSize:48,color:"success.main",mb:2}}),e.jsx(d,{variant:"h6",sx:{fontWeight:"bold",color:"success.dark",mb:1,textAlign:"center"},children:"All Products Categorized!"}),e.jsx(d,{variant:"body2",color:"text.secondary",textAlign:"center",children:"Great job! All products have categories."})]}):e.jsxs(n,{children:[e.jsx(d,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"warning.dark"},children:"Needs Categories"}),e.jsx(U,{products:a,onEdit:o,onFilterChange:u,onBulkCategoryUpdate:j})]})}),c&&e.jsx(F,{product:c,onClose:()=>o(null),onSave:b})]})}):e.jsx(q,{maxWidth:!1,sx:{py:3},children:e.jsxs(z,{sx:{p:3,mb:4,borderRadius:2},children:[e.jsx(n,{sx:{display:"flex",alignItems:"center",mb:3,justifyContent:"space-between"},children:e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(G,{sx:{fontSize:32,mr:2,color:"warning.main"}}),e.jsx(d,{variant:"h4",component:"h1",sx:{fontWeight:"bold",color:"warning.dark"},children:"Uncategorized Products"}),e.jsx(y,{label:`${a.length} Products`,color:"warning",size:"medium",sx:{ml:2}})]})}),"        ",a.length>0&&e.jsxs(P,{severity:"warning",sx:{mb:3},children:[e.jsx(w,{children:"Action Required"}),"You have ",a.length," product(s) without categories. Products without categories may not appear in reports and analytics correctly. Please assign categories to these products for better organization and tracking."]}),e.jsx(_,{sx:{mb:3}}),e.jsx(n,{sx:{width:"100%"},children:m?e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",m:4,children:e.jsx(A,{color:"warning",size:40,thickness:4})}):a.length===0?e.jsxs(n,{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",py:8,children:[e.jsx(v,{sx:{fontSize:64,color:"success.main",mb:2}}),e.jsx(d,{variant:"h5",sx:{fontWeight:"bold",color:"success.dark",mb:1},children:"All Products Categorized!"}),e.jsx(d,{variant:"body1",color:"text.secondary",textAlign:"center",children:"Great job! All your products have been assigned to categories. This helps with better organization and reporting."})]}):e.jsxs(n,{children:[e.jsx(d,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"warning.dark"},children:"Products Requiring Category Assignment"}),e.jsx(U,{products:a,onEdit:o,onFilterChange:u,onBulkCategoryUpdate:j})]})}),c&&e.jsx(F,{product:c,onClose:()=>o(null),onSave:b})]})})};export{be as UncategorizedProductsPage,be as default};
