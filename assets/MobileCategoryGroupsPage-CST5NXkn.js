import{j as e,B as s,J as z,h as i,W as w,ai as m,G as M,aT as _,aC as L,C as y,A as I,ak as R}from"./mui-vendor-DlldRxor.js";import{a as u}from"./react-vendor-C0s_J9t-.js";import{M as A}from"./MobileAppShell-dHUJWRrR.js";import{u as D,M as T}from"./useInfiniteScroll-C2oDQ5Wg.js";import{M as P}from"./MobileCard-BmxjauOU.js";import{i as W,j,o as $,aa as B,ae as E,t as C}from"./index-D4QRAU_W.js";import{u as H}from"./usePullToRefresh-C2FNOxJ5.js";import"./redux-vendor-tKFe_QvA.js";import"./firebase-vendor-40dJGoDN.js";import"./utils-vendor-CFocuF-S.js";import"./pdf-vendor-DisdNAgy.js";const N=({categoryGroup:t,onTap:r})=>{const o=(()=>{const{currentInventory:a,minimumThreshold:n}=t;return a<0?"negative_stock":a===0?"zero_stock":a<=n?"low_stock":"healthy"})(),x=Math.min(t.currentInventory/(t.minimumThreshold*2)*100,100),c=(a=>{const n=parseInt(a.slice(1,3),16),p=parseInt(a.slice(3,5),16),g=parseInt(a.slice(5,7),16);return(.299*n+.587*p+.114*g)/255>.5?"#000000":"#ffffff"})(t.color),d={healthy:{label:"In Stock",color:"success"},low_stock:{label:"Low Stock",color:"warning"},zero_stock:{label:"Out of Stock",color:"error"},negative_stock:{label:"Negative Stock",color:"error"}}[o];return e.jsxs(P,{onClick:()=>r==null?void 0:r(t),sx:{minHeight:88,cursor:"pointer"},children:[e.jsxs(s,{sx:{backgroundColor:t.color,color:c,px:2,py:1.5,display:"flex",alignItems:"center",gap:1},children:[e.jsx(z,{sx:{fontSize:20}}),e.jsx(i,{variant:"h6",sx:{fontWeight:600,fontSize:"16px",flex:1},children:t.name}),o==="low_stock"||o==="zero_stock"||o==="negative_stock"?e.jsx(w,{sx:{fontSize:20}}):null]}),e.jsxs(s,{sx:{p:2,display:"flex",flexDirection:"column",gap:1.5},children:[t.description&&e.jsx(i,{variant:"body2",color:"text.secondary",sx:{fontSize:"14px"},children:t.description}),e.jsxs(s,{sx:{display:"flex",gap:1,alignItems:"center",flexWrap:"wrap"},children:[e.jsx(m,{icon:e.jsx(M,{}),label:`${t.categoryCount} ${t.categoryCount===1?"category":"categories"}`,size:"small",variant:"outlined",sx:{fontSize:"12px",height:28}}),e.jsx(m,{label:d.label,size:"small",color:d.color,sx:{fontSize:"12px",height:28}}),e.jsx(m,{icon:e.jsx(_,{}),label:`${t.currentInventory} ${t.inventoryUnit}`,size:"small",variant:"outlined",sx:{fontSize:"12px",height:28}})]}),e.jsxs(s,{sx:{mt:.5},children:[e.jsxs(s,{sx:{display:"flex",justifyContent:"space-between",mb:.5},children:[e.jsx(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"11px"},children:"Inventory Level"}),e.jsxs(i,{variant:"caption",color:"text.secondary",sx:{fontSize:"11px"},children:["Threshold: ",t.minimumThreshold," ",t.inventoryUnit]})]}),e.jsx(L,{variant:"determinate",value:x,sx:{height:6,borderRadius:3,backgroundColor:"rgba(0, 0, 0, 0.1)","& .MuiLinearProgress-bar":{borderRadius:3,backgroundColor:o==="zero_stock"||o==="negative_stock"||o==="low_stock"?"#f44336":"#4caf50"}}})]})]})]})},Z=()=>{const t=W(),r=j($),h=j(B),o=j(E),[x,v]=u.useState(""),[c,b]=u.useState(20);u.useEffect(()=>{t(C())},[t]);const{state:d,containerRef:a}=H(async()=>{await t(C()).unwrap()},{threshold:80,enabled:!0}),n=u.useMemo(()=>{if(!x)return r;const l=x.toLowerCase();return r.filter(f=>f.name.toLowerCase().includes(l)||f.description&&f.description.toLowerCase().includes(l))},[r,x]),p=n.slice(0,c),{sentinelRef:g}=D({onLoadMore:()=>{c<n.length&&b(l=>Math.min(l+20,n.length))},isLoading:h,hasMore:c<n.length,threshold:100}),S=l=>{},k=()=>{t(C())};return e.jsx(A,{pageTitle:"Category Groups",children:e.jsxs(s,{ref:a,sx:{flex:1,overflow:"auto",WebkitOverflowScrolling:"touch",pb:10},children:[d.isRefreshing&&e.jsx(s,{sx:{position:"absolute",top:0,left:0,right:0,display:"flex",justifyContent:"center",pt:2,zIndex:1},children:e.jsx(y,{size:24})}),e.jsx(s,{sx:{p:2,pb:1},children:e.jsx(T,{value:x,onChange:v,placeholder:"Search category groups...",autoFocus:!1})}),o&&e.jsx(s,{sx:{p:2},children:e.jsx(I,{severity:"error",action:e.jsx(i,{variant:"button",sx:{cursor:"pointer",textDecoration:"underline"},onClick:k,children:"Retry"}),children:o})}),h&&r.length===0&&e.jsx(s,{sx:{display:"flex",justifyContent:"center",alignItems:"center",minHeight:200},children:e.jsx(y,{})}),!h&&r.length===0&&!o&&e.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:300,px:4,textAlign:"center",gap:2},children:[e.jsx(R,{sx:{fontSize:48,color:"text.secondary"}}),e.jsx(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Category Groups"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Category groups help organize categories with colors and inventory tracking."}),e.jsx(I,{severity:"info",sx:{mt:2},children:"Category groups can be created and managed on the desktop version of this app."})]}),!h&&r.length>0&&n.length===0&&e.jsxs(s,{sx:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",minHeight:200,px:4,textAlign:"center"},children:[e.jsx(i,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Results Found"}),e.jsx(i,{variant:"body2",color:"text.secondary",children:"Try adjusting your search terms"})]}),p.length>0&&e.jsxs(s,{sx:{p:2,pt:1,display:"flex",flexDirection:"column",gap:2},children:[p.map(l=>e.jsx(N,{categoryGroup:l,onTap:S},l.id)),c<n.length&&e.jsx(s,{ref:g,sx:{py:2,display:"flex",justifyContent:"center"},children:e.jsx(y,{size:32})}),c>=n.length&&n.length>0&&e.jsx(s,{sx:{py:2,textAlign:"center"},children:e.jsx(i,{variant:"caption",color:"text.secondary",children:n.length===1?"1 group":`${n.length} groups`})})]})]})})};export{Z as MobileCategoryGroupsPage,Z as default};
