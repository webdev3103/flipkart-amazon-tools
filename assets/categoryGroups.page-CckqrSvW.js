const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MobileCategoryGroupsPage-CST5NXkn.js","assets/mui-vendor-DlldRxor.js","assets/react-vendor-C0s_J9t-.js","assets/MobileAppShell-dHUJWRrR.js","assets/index-D4QRAU_W.js","assets/redux-vendor-tKFe_QvA.js","assets/firebase-vendor-40dJGoDN.js","assets/utils-vendor-CFocuF-S.js","assets/pdf-vendor-DisdNAgy.js","assets/useInfiniteScroll-C2oDQ5Wg.js","assets/MobileCard-BmxjauOU.js","assets/usePullToRefresh-C2FNOxJ5.js"])))=>i.map(i=>d[i]);
import{_ as de}from"./pdf-vendor-DisdNAgy.js";import{j as e,B as n,A as W,C as T,a3 as S,J as B,h as o,al as O,am as z,an as _,ap as N,k as C,ai as Q,G as w,T as U,I as $,aZ as ue,aO as he,Y as A,a9 as H,Q as Y,ar as xe,bk as me,D as pe,p as ge,r as je,n as fe,o as ye,S as Ce}from"./mui-vendor-DlldRxor.js";import{a as i}from"./react-vendor-C0s_J9t-.js";import{i as V,j as I,o as Z,aa as K,ae as X,t as R,af as ee,ag as be,ah as J,ai as ve,aj as Se,u as Ie,z as Ge,ad as ke}from"./index-D4QRAU_W.js";import{D as De}from"./DataTable-CqcHOsap.js";import{u as We,c as we,a as E}from"./index.esm-HlV1qfyK.js";import"./redux-vendor-tKFe_QvA.js";import"./firebase-vendor-40dJGoDN.js";import"./utils-vendor-CFocuF-S.js";const Te=({onEditGroup:c,onViewGroupDetails:b,refreshTrigger:a=0})=>{const h=V(),j=I(Z),f=I(K),x=I(X),[y,d]=i.useState(!1),[r,m]=i.useState(null),G=[{id:"name",label:"Group Name",filter:!0,priorityOnMobile:!0,format:t=>e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsx(B,{sx:{mr:1,color:"text.secondary"}}),e.jsx(o,{variant:"subtitle1",fontWeight:"medium",children:String(t)})]})},{id:"color",label:"Color",align:"center",filter:!0,filterValue:t=>t.color,format:t=>e.jsx(Q,{label:String(t),size:"small",sx:{backgroundColor:String(t),color:p(String(t)),fontWeight:"medium",minWidth:80}})},{id:"categoryCount",label:"Categories",align:"center",format:(t,u)=>e.jsx(n,{display:"flex",alignItems:"center",justifyContent:"center",children:e.jsx(C,{variant:"outlined",size:"small",onClick:g=>{g.stopPropagation(),b(u)},startIcon:e.jsx(w,{sx:{fontSize:20}}),sx:{minWidth:80},children:String(t)})})},{id:"actions",label:"Actions",align:"center",format:(t,u)=>e.jsxs(n,{display:"flex",justifyContent:"center",gap:1,children:[e.jsx(U,{title:"Edit Group",children:e.jsx($,{size:"small",onClick:g=>{g.stopPropagation(),c(u)},color:"primary",children:e.jsx(ue,{})})}),e.jsx(U,{title:u.categoryCount>0?"Cannot delete group with categories":"Delete Group",children:e.jsx("span",{children:e.jsx($,{size:"small",onClick:g=>{g.stopPropagation(),k(u)},color:"error",disabled:u.categoryCount>0,children:e.jsx(he,{})})})})]})}];i.useEffect(()=>{h(R())},[h,a]),i.useEffect(()=>{if(x){const t=setTimeout(()=>{h(ee())},5e3);return()=>clearTimeout(t)}},[x,h]);const k=t=>{m(t),d(!0)},D=async()=>{if(r)try{await h(be(r.id)).unwrap(),d(!1),m(null)}catch{d(!1),m(null)}},s=()=>{d(!1),m(null)},p=t=>{const u=parseInt(t.slice(1,3),16),g=parseInt(t.slice(3,5),16),P=parseInt(t.slice(5,7),16);return(.299*u+.587*g+.114*P)/255>.5?"#000000":"#ffffff"};return e.jsxs(n,{children:[x&&e.jsx(W,{severity:"error",sx:{mb:2},children:x}),f&&j.length===0?e.jsx(n,{display:"flex",justifyContent:"center",alignItems:"center",minHeight:200,children:e.jsx(T,{})}):j.length===0?e.jsxs(S,{sx:{p:4,textAlign:"center"},children:[e.jsx(B,{sx:{fontSize:48,color:"text.secondary",mb:2}}),e.jsx(o,{variant:"h6",color:"text.secondary",gutterBottom:!0,children:"No Category Groups Found"}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Create your first category group to organize your categories with colors and descriptions."})]}):e.jsx(De,{columns:G,data:j,defaultSortColumn:"name",defaultSortDirection:"asc",rowsPerPageOptions:[10,25,50],defaultRowsPerPage:25,getRowId:t=>t.id}),e.jsxs(O,{open:y,onClose:s,children:[e.jsx(z,{children:"Delete Category Group"}),e.jsxs(_,{children:[e.jsxs(o,{children:['Are you sure you want to delete "',r==null?void 0:r.name,'"? This action cannot be undone.']}),(r==null?void 0:r.categoryCount)===0&&e.jsx(W,{severity:"info",sx:{mt:2},children:"This group has no categories assigned and can be safely deleted."})]}),e.jsxs(N,{children:[e.jsx(C,{onClick:s,children:"Cancel"}),e.jsx(C,{onClick:D,color:"error",variant:"contained",disabled:f,children:f?e.jsx(T,{size:20}):"Delete"})]})]})]})},Be=we({name:E().required("Group name is required").min(2,"Name must be at least 2 characters").max(100,"Name must be 100 characters or less"),description:E().max(500,"Description must be 500 characters or less"),color:E().required("Color is required").matches(/^#[0-9A-F]{6}$/i,"Color must be a valid hex color")}),Pe=({open:c,onClose:b,editingGroup:a,onSuccess:h})=>{const j=V(),f=I(K),x=I(X),[y,d]=i.useState(""),r=We({initialValues:{name:"",description:"",color:J[0],currentInventory:0,inventoryUnit:"pcs",inventoryType:"qty",minimumThreshold:10},validationSchema:Be,onSubmit:async s=>{try{a?await j(ve({id:a.id,groupData:s})).unwrap():await j(Se(s)).unwrap(),m(),h==null||h()}catch(p){console.error("Failed to save category group:",p)}}});i.useEffect(()=>{c&&(a?(r.setValues({name:a.name,description:a.description,color:a.color,currentInventory:a.currentInventory,inventoryUnit:a.inventoryUnit,inventoryType:a.inventoryType,minimumThreshold:a.minimumThreshold}),d(a.color)):(r.resetForm(),d("")))},[c,a]);const m=()=>{r.resetForm(),d(""),b()},G=s=>{r.setFieldValue("color",s),d(s)},k=s=>{const p=s.target.value;d(p),p.match(/^#[0-9A-F]{6}$/i)&&r.setFieldValue("color",p)},D=s=>{try{const p=parseInt(s.slice(1,3),16),t=parseInt(s.slice(3,5),16),u=parseInt(s.slice(5,7),16);return(.299*p+.587*t+.114*u)/255>.5?"#000000":"#ffffff"}catch{return"#000000"}};return e.jsx(O,{open:c,onClose:m,maxWidth:"md",fullWidth:!0,PaperProps:{sx:{borderRadius:2}},children:e.jsxs("form",{onSubmit:r.handleSubmit,children:[e.jsx(z,{children:e.jsx(o,{variant:"h6",fontWeight:"bold",children:a?"Edit Category Group":"Create New Category Group"})}),e.jsxs(_,{dividers:!0,children:[x&&e.jsx(W,{severity:"error",sx:{mb:3},children:x}),e.jsxs(n,{sx:{mb:3},children:[e.jsx(A,{fullWidth:!0,label:"Group Name",name:"name",value:r.values.name,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.name&&!!r.errors.name,helperText:r.touched.name&&r.errors.name,sx:{mb:3},placeholder:"e.g., Electronics, Books, Fashion"}),e.jsx(A,{fullWidth:!0,label:"Description",name:"description",multiline:!0,rows:3,value:r.values.description,onChange:r.handleChange,onBlur:r.handleBlur,error:r.touched.description&&!!r.errors.description,helperText:r.touched.description&&r.errors.description,sx:{mb:3},placeholder:"Describe this category group..."})]}),e.jsxs(n,{sx:{mb:2},children:[e.jsx(o,{variant:"subtitle1",fontWeight:"medium",gutterBottom:!0,children:"Select Color"}),e.jsxs(n,{sx:{mb:2},children:[e.jsx(o,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Predefined Colors"}),e.jsx(H,{container:!0,spacing:1,children:J.map(s=>e.jsx(H,{item:!0,children:e.jsx(S,{sx:{width:40,height:40,backgroundColor:s,cursor:"pointer",border:r.values.color===s?"3px solid #1976d2":"1px solid #ddd",borderRadius:1,display:"flex",alignItems:"center",justifyContent:"center","&:hover":{transform:"scale(1.1)"},transition:"all 0.2s ease"},onClick:()=>G(s),children:r.values.color===s&&e.jsx(o,{sx:{color:D(s),fontSize:"18px",fontWeight:"bold"},children:"âœ“"})})},s))})]}),e.jsxs(n,{children:[e.jsx(o,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Custom Color"}),e.jsxs(n,{display:"flex",alignItems:"center",gap:2,children:[e.jsx(A,{label:"Hex Color",value:y,onChange:k,placeholder:"#FF5722",error:r.touched.color&&!!r.errors.color,helperText:r.touched.color&&r.errors.color,sx:{minWidth:120}}),y&&y.match(/^#[0-9A-F]{6}$/i)&&e.jsx(S,{sx:{width:40,height:40,backgroundColor:y,border:"1px solid #ddd",borderRadius:1}})]})]}),r.values.color&&e.jsxs(n,{sx:{mt:2},children:[e.jsx(o,{variant:"body2",color:"text.secondary",gutterBottom:!0,children:"Preview"}),e.jsxs(S,{sx:{p:2,backgroundColor:r.values.color,color:D(r.values.color),borderRadius:2,maxWidth:200},children:[e.jsx(o,{variant:"subtitle1",fontWeight:"bold",children:r.values.name||"New Category Group"}),e.jsx(o,{variant:"body2",sx:{opacity:.9},children:r.values.description||"Enter a description for this group"})]})]})]})]}),e.jsxs(N,{sx:{p:2},children:[e.jsx(C,{onClick:m,disabled:f,children:"Cancel"}),e.jsx(C,{type:"submit",variant:"contained",disabled:f||!r.isValid,children:f?e.jsx(T,{size:20}):a?"Update Group":"Create Group"})]})]})})},Fe=i.lazy(()=>de(()=>import("./MobileCategoryGroupsPage-CST5NXkn.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11])).then(c=>({default:c.MobileCategoryGroupsPage}))),Ae=()=>{const c=V(),b=I(Ge),a=I(Z),[h,j]=i.useState(!1),[f,x]=i.useState(null),[y,d]=i.useState(!1),[r,m]=i.useState(null),[G,k]=i.useState([]),[D,s]=i.useState(0),[p,t]=i.useState(!1),[u,g]=i.useState(""),[P,F]=i.useState("success"),re=new ke;i.useEffect(()=>{b&&c(R())},[c,b]);const L=()=>{c(R()),s(l=>l+1)},te=()=>{x(null),j(!0)},se=l=>{x(l),j(!0)},oe=()=>{j(!1),x(null),c(ee())},ne=()=>{g(f?"Category group updated successfully!":"Category group created successfully!"),F("success"),t(!0),L()},ae=async l=>{m(l);try{const v=await re.getCategoriesByGroup(l.id);k(v),d(!0)}catch(v){g("Failed to load group details"),F("error"),t(!0),console.error("Failed to load group details:",v)}},M=()=>{d(!1),m(null),k([])},q=()=>{t(!1)},ie=l=>{try{const v=parseInt(l.slice(1,3),16),le=parseInt(l.slice(3,5),16),ce=parseInt(l.slice(5,7),16);return(.299*v+.587*le+.114*ce)/255>.5?"#000000":"#ffffff"}catch{return"#000000"}};return b?e.jsxs(Y,{maxWidth:!1,sx:{py:3},children:[e.jsxs(S,{sx:{p:3,mb:4,borderRadius:2},children:[e.jsxs(n,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(B,{sx:{fontSize:32,mr:2,color:"primary.main"}}),e.jsx(o,{variant:"h4",component:"h1",sx:{fontWeight:"bold",color:"primary.dark"},children:"Category Groups"}),e.jsx(n,{sx:{flexGrow:1}}),e.jsx(C,{variant:"outlined",onClick:L,startIcon:e.jsx(xe,{}),sx:{mr:2,fontWeight:"medium"},children:"Refresh"}),e.jsx(C,{variant:"contained",onClick:te,startIcon:e.jsx(me,{}),sx:{fontWeight:"medium"},children:"Create Group"})]}),e.jsx(pe,{sx:{mb:3}}),e.jsxs(n,{sx:{mb:3,display:"flex",gap:3,flexWrap:"wrap"},children:[e.jsx(S,{sx:{p:2,minWidth:200,borderRadius:2},children:e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsx(B,{sx:{color:"primary.main",mr:1}}),e.jsxs(n,{children:[e.jsx(o,{variant:"h5",fontWeight:"bold",children:a.length}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Total Groups"})]})]})}),e.jsx(S,{sx:{p:2,minWidth:200,borderRadius:2},children:e.jsxs(n,{display:"flex",alignItems:"center",children:[e.jsx(w,{sx:{color:"success.main",mr:1}}),e.jsxs(n,{children:[e.jsx(o,{variant:"h5",fontWeight:"bold",children:a.reduce((l,v)=>l+v.categoryCount,0)}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"Assigned Categories"})]})]})})]}),e.jsx(Te,{onEditGroup:se,onViewGroupDetails:ae,refreshTrigger:D})]}),e.jsx(Pe,{open:h,onClose:oe,editingGroup:f,onSuccess:ne}),e.jsxs(O,{open:y,onClose:M,maxWidth:"sm",fullWidth:!0,children:[e.jsx(z,{children:e.jsxs(n,{display:"flex",alignItems:"center",gap:2,children:[r&&e.jsx(Q,{label:r.name,sx:{backgroundColor:r.color,color:ie(r.color),fontWeight:"bold"}}),e.jsx(o,{variant:"h6",children:"Group Details"})]})}),e.jsxs(_,{dividers:!0,children:[r&&e.jsxs(n,{sx:{mb:3},children:[e.jsxs(o,{variant:"body1",gutterBottom:!0,children:[e.jsx("strong",{children:"Description:"})," ",r.description||"No description"]}),e.jsxs(o,{variant:"body1",gutterBottom:!0,children:[e.jsx("strong",{children:"Color:"})," ",r.color]}),e.jsxs(o,{variant:"body1",gutterBottom:!0,children:[e.jsx("strong",{children:"Categories:"})," ",r.categoryCount]})]}),e.jsx(o,{variant:"h6",gutterBottom:!0,children:"Associated Categories"}),G.length===0?e.jsxs(n,{sx:{p:2,textAlign:"center",bgcolor:"grey.50",borderRadius:1},children:[e.jsx(w,{sx:{fontSize:40,color:"text.secondary",mb:1}}),e.jsx(o,{variant:"body2",color:"text.secondary",children:"No categories assigned to this group yet."})]}):e.jsx(ge,{dense:!0,children:G.map(l=>e.jsxs(je,{children:[e.jsx(fe,{children:e.jsx(w,{fontSize:"small"})}),e.jsx(ye,{primary:l.name})]},l.id))})]}),e.jsx(N,{children:e.jsx(C,{onClick:M,children:"Close"})})]}),e.jsx(Ce,{open:p,autoHideDuration:6e3,onClose:q,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(W,{onClose:q,severity:P,sx:{width:"100%"},children:u})})]}):e.jsx(Y,{maxWidth:"xl",sx:{py:3},children:e.jsx(W,{severity:"warning",children:"Please log in to manage category groups."})})},Ue=()=>Ie()?e.jsx(i.Suspense,{fallback:e.jsx(n,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(T,{})}),children:e.jsx(Fe,{})}):e.jsx(Ae,{});export{Ue as default};
