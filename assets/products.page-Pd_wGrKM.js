const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/MobileProductsPage-B_Ic_Hv3.js","assets/mui-vendor-DlldRxor.js","assets/react-vendor-C0s_J9t-.js","assets/MobileAppShell-dHUJWRrR.js","assets/index-D4QRAU_W.js","assets/redux-vendor-tKFe_QvA.js","assets/firebase-vendor-40dJGoDN.js","assets/utils-vendor-CFocuF-S.js","assets/pdf-vendor-DisdNAgy.js","assets/MobileCard-BmxjauOU.js","assets/InventoryStatusChip-Dd2kFZgD.js","assets/useInfiniteScroll-C2oDQ5Wg.js","assets/MobileModal-BBoQbQka.js","assets/MobileBarcodeScanner-C2yMGKQf.js","assets/usePullToRefresh-C2FNOxJ5.js"])))=>i.map(i=>d[i]);
import{_ as N}from"./pdf-vendor-DisdNAgy.js";import{j as e,B as c,a1 as T,a2 as z,T as W,ak as V,k as O,aV as R,S as F,A as L,ai as g,I as $,aZ as H,C as E,Q as Z,a3 as G,aT as K,h as w,D as Q}from"./mui-vendor-DlldRxor.js";import{a as i,b as X}from"./react-vendor-C0s_J9t-.js";import{i as A,I as Y,j as C,V as q,u as J,z as ee,A as te,X as ae,Y as se,Z as re,_ as oe}from"./index-D4QRAU_W.js";import{P as ne,a as ie}from"./ProductTableToolbar-5drI2qdY.js";import{D as le}from"./DataTable-CqcHOsap.js";import{F as ce}from"./FormattedCurrency-CWfs6hb7.js";import{V as de,a as ue}from"./ActionButtons-BOIGwPW5.js";import"./redux-vendor-tKFe_QvA.js";import"./firebase-vendor-40dJGoDN.js";import"./utils-vendor-CFocuF-S.js";const me=({onImport:s})=>{const[u,d]=i.useState(null),[f,m]=i.useState(!1),p=async n=>{var x;const l=(x=n.target.files)==null?void 0:x[0];if(l){if(!l.name.endsWith(".xlsx")&&!l.name.endsWith(".xls")&&!l.name.endsWith(".txt")){d("Please upload an Excel file (.xlsx or .xls)");return}try{d(null),await s(l,f)}catch{d("Failed to import products. Please check the file format.")}n.target.value=""}};return e.jsxs(c,{sx:{display:"flex",flexDirection:"column",alignItems:"flex-end",gap:1},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",gap:1},children:[e.jsx(T,{control:e.jsx(z,{checked:f,onChange:n=>m(n.target.checked),size:"small"}),label:"Update existing products",sx:{mr:2}}),e.jsx(W,{title:"When checked, existing products will be updated with new prices and metadata from the import file. User customizations (cost price, categories, visibility) will be preserved.",children:e.jsx(V,{sx:{fontSize:20,color:"text.secondary",cursor:"help"}})})]}),e.jsxs(O,{variant:"contained",component:"label",startIcon:e.jsx(R,{}),children:["Import Products",e.jsx("input",{type:"file",hidden:!0,accept:".xlsx,.xls,.txt",onChange:p})]}),e.jsx(F,{open:!!u,autoHideDuration:6e3,onClose:()=>d(null),message:u})]})},pe=({products:s,allProducts:u,onEdit:d,onFilterChange:f,onBulkCategoryUpdate:m})=>{const p=A(),[n,l]=i.useState([]),[x,b]=i.useState({}),[y,r]=i.useState(!1),[h,S]=i.useState(""),[v]=i.useState("success");i.useEffect(()=>{p(Y())},[p]);const j=C(q),D=t=>{b(t),f(t)},U=t=>{l(a=>a.includes(t)?a.filter(o=>o!==t):[...a,t])},_=async(t,a)=>{if(m)try{await m(t,a),l([]);const o=P(a);S(`Successfully assigned ${t.length} product(s) to category "${o}"`),r(!0)}catch{S("Failed to assign category to products"),r(!0)}},k=()=>{r(!1)},P=t=>{if(!t||!Array.isArray(j))return"-";const a=j.find(o=>o.id===t);return a?a.name:"-"},I=t=>"category"in t,B=[{id:"select",label:"",format:(t,a)=>a?e.jsx(z,{checked:n.includes(a.sku),onChange:()=>U(a.sku)}):null},{id:"sku",label:"SKU",filter:!0},{id:"name",label:"Name",filter:!0},{id:"categoryId",label:"Category",filter:!0,format:(t,a)=>{const o=a;return I(o)&&o.category?e.jsx(g,{label:o.category.name,size:"small"}):e.jsx(g,{label:P(t),size:"small"})},filterValue:t=>{const a=t;return I(a)&&a.category?a.category.name:P(t.categoryId)}},{id:"platform",label:"Platform",format:t=>{const a=t;return e.jsx(g,{label:a.toUpperCase(),color:t==="amazon"?"default":"primary"})},filter:!0},{id:"sellingPrice",label:"Selling Price",align:"right",format:t=>e.jsx(ce,{value:t})},{id:"actions",label:"Actions",align:"center",format:(t,a)=>M(a)}],M=t=>{var a,o;return e.jsxs(e.Fragment,{children:[e.jsx($,{size:"small","aria-label":`edit-${t.sku}`,onClick:()=>d(t),children:e.jsx(H,{})}),((a=t.metadata)==null?void 0:a.flipkartSerialNumber)&&e.jsx(de,{flipkartSerialNumber:t.metadata.flipkartSerialNumber}),((o=t.metadata)==null?void 0:o.amazonSerialNumber)&&e.jsx(ue,{amazonSerialNumber:t.metadata.amazonSerialNumber})]})};return e.jsxs(c,{sx:{width:"100%"},children:[e.jsx(ne,{platform:x.platform,search:x.search,selectedProducts:n,categories:j,allProducts:u||s,onFilterChange:D,onBulkCategoryUpdate:_}),e.jsx(le,{columns:B,data:s,defaultSortColumn:"sku",defaultSortDirection:"asc",rowsPerPageOptions:[10,25,50],defaultRowsPerPage:10}),e.jsx(F,{open:y,autoHideDuration:6e3,onClose:k,anchorOrigin:{vertical:"bottom",horizontal:"right"},children:e.jsx(L,{onClose:k,severity:v,sx:{width:"100%"},children:h})})]})},xe=i.lazy(()=>N(()=>import("./MobileProductsPage-B_Ic_Hv3.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14])).then(s=>({default:s.MobileProductsPage}))),he=()=>{const s=A(),{items:u,filteredItems:d,loading:f}=C(r=>r.products),m=C(ee),[p,n]=X.useState(null);i.useEffect(()=>{m&&s(te({}))},[s,m]);const l=async(r,h)=>{try{await s(ae({file:r,updateExisting:h})).unwrap()}catch{}},x=async(r,h)=>{try{await s(oe({sku:r,data:h})).unwrap(),n(null)}catch{}},b=async(r,h)=>{try{await s(se({skus:r,data:{categoryId:h}})).unwrap()}catch{}},y=r=>{s(re(r))};return e.jsx(Z,{maxWidth:!1,sx:{py:3},children:e.jsxs(G,{sx:{p:3,mb:4,borderRadius:2},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",mb:3,justifyContent:"space-between"},children:[e.jsxs(c,{sx:{display:"flex",alignItems:"center",mb:3},children:[e.jsx(K,{sx:{fontSize:32,mr:2,color:"primary.main"}}),e.jsx(w,{variant:"h4",component:"h1",sx:{fontWeight:"bold",color:"primary.dark"},children:"Product Management"}),e.jsx(g,{label:`${u.length} Products`,color:"primary",size:"medium",sx:{ml:2}})]}),e.jsx(me,{onImport:l})]}),e.jsx(Q,{sx:{mb:3}}),e.jsx(c,{sx:{width:"100%"},children:f?e.jsx(c,{display:"flex",justifyContent:"center",alignItems:"center",m:4,children:e.jsx(E,{color:"primary",size:40,thickness:4})}):e.jsxs(c,{children:[e.jsx(w,{variant:"h6",sx:{mb:2,fontWeight:"bold",color:"primary.dark"},children:"Product Catalog"}),e.jsx(pe,{products:d,allProducts:u,onEdit:n,onFilterChange:y,onBulkCategoryUpdate:b})]})}),p&&e.jsx(ie,{product:p,onClose:()=>n(null),onSave:x})]})})},ze=()=>J()?e.jsx(i.Suspense,{fallback:e.jsx(c,{sx:{display:"flex",justifyContent:"center",alignItems:"center",height:"100vh"},children:e.jsx(E,{})}),children:e.jsx(xe,{})}):e.jsx(he,{});export{ze as ProductsPage,ze as default};
