import{j as e,b0 as ue,b1 as G,b2 as F,a2 as N,b3 as fe,B as f,Y as re,I as W,b5 as ie,b6 as oe,x as le,a3 as U,h as D,D as K,Z as se,ax as ge,as as je,bR as be,ai as me,bS as Ce,bT as Se,a9 as ne,k as q,u as ye,d as ve,ac as we,bq as ae,a_ as Te,a$ as ke,b4 as Pe}from"./mui-vendor-DlldRxor.js";import{a as P,b as v}from"./react-vendor-C0s_J9t-.js";import{aO as Ie}from"./index-D4QRAU_W.js";function Re(l){const{columns:i,orderBy:d,order:j,filters:g,onRequestSort:w,onFilterChange:b,enableSelection:C,selected:r=[],onSelectAll:h,visibleRowIds:p=[]}=l,u=p.length>0&&p.every(s=>r.includes(s)),m=p.some(s=>r.includes(s));return e.jsx(ue,{children:e.jsxs(G,{children:[C&&e.jsx(F,{padding:"checkbox",children:e.jsx(N,{indeterminate:m&&!u,checked:u,onChange:s=>h==null?void 0:h(s.target.checked,p),inputProps:{"aria-label":"select all"}})}),i.map(s=>e.jsxs(F,{align:s.align,sortDirection:d===s.id?j:!1,sx:{minWidth:s.minWidth,width:"auto"},children:[e.jsx(fe,{active:d===s.id,direction:d===s.id?j:"asc",onClick:()=>w(s.id),children:s.label}),s.filter&&e.jsx(f,{sx:{mt:1},children:e.jsx(re,{size:"small",placeholder:`Filter ${s.label}`,value:g[s.id]||"",onChange:c=>b(s.id,c.target.value),fullWidth:!0})})]},String(s.id)))]})})}const De=P.memo(Re);function Oe(l){const{row:i,columns:d,index:j,onClick:g,enableSelection:w,selected:b=!1,onSelect:C,rowId:r,renderCollapse:h,isExpanded:p=!1,onExpand:u}=l,m=x=>{x.stopPropagation(),C&&r!==void 0&&C(r,x.target.checked)},s=x=>{x.stopPropagation(),u&&u(!p)},c=x=>{x.stopPropagation()};return e.jsxs(v.Fragment,{children:[e.jsxs(G,{hover:!0,onClick:()=>g==null?void 0:g(i),sx:{cursor:g?"pointer":"default"},children:[h&&e.jsx(F,{padding:"checkbox",children:e.jsx(W,{"aria-label":"expand row",size:"small",onClick:s,children:p?e.jsx(ie,{}):e.jsx(oe,{})})}),w&&e.jsx(F,{padding:"checkbox",onClick:c,children:e.jsx(N,{checked:b,onChange:m,inputProps:{"aria-label":"select row"}})}),d.map(x=>{const S=i[x.id];return e.jsx(F,{align:x.align,sx:{minWidth:x.minWidth,width:"auto"},children:x.format?x.format(S,i):String(S??"")},String(x.id))})]},j),h&&e.jsx(G,{children:e.jsx(F,{style:{paddingBottom:0,paddingTop:0},colSpan:d.length+(w?1:0)+1,children:e.jsx(le,{in:p,timeout:"auto",unmountOnExit:!0,children:e.jsx(f,{sx:{margin:1},children:h(i)})})})})]})}const Be=P.memo(Oe),Fe=({columns:l,row:i,onSelect:d,selectable:j,selected:g,idField:w="id",onRowClick:b})=>{const[C,r]=P.useState(!1),h=()=>{b&&b(i)},p=s=>{s.stopPropagation(),d&&d(i[w],!g)},u=l[0],m=i[u.id];return e.jsxs(U,{elevation:1,sx:{mb:1,overflow:"hidden",cursor:b?"pointer":"default"},onClick:b?h:void 0,children:[e.jsxs(f,{sx:{display:"flex",alignItems:"center",p:1.5,justifyContent:"space-between"},children:[e.jsxs(f,{sx:{display:"flex",alignItems:"center"},children:[j&&e.jsx(f,{sx:{mr:1.5},onClick:p,children:e.jsx(N,{checked:!!g})}),e.jsxs(f,{children:[e.jsx(D,{variant:"body1",fontWeight:"medium",children:String(m??"")}),e.jsx(D,{variant:"body2",color:"text.secondary",children:l[1]&&String(i[l[1].id]??"")})]})]}),e.jsx(W,{size:"small",onClick:s=>{s.stopPropagation(),r(!C)},children:C?e.jsx(ie,{}):e.jsx(oe,{})})]}),e.jsx(le,{in:C,timeout:"auto",unmountOnExit:!0,children:e.jsx(f,{sx:{p:1.5,pt:0},children:l.slice(2).map(s=>e.jsxs(f,{sx:{mb:1.5},children:[e.jsxs(D,{variant:"body2",color:"text.secondary",component:"span",children:[s.label,":"]}),e.jsx(D,{variant:"body1",component:"span",sx:{ml:1},children:s.format?s.format(i[s.id],i):String(i[s.id]??"")}),e.jsx(K,{sx:{mt:1.5}})]},String(s.id)))})})]})};function Ee(l){const{columns:i,orderBy:d,order:j,filters:g,onRequestSort:w,onFilterChange:b}=l,[C,r]=P.useState(!1),[h,p]=P.useState(""),[u,m]=P.useState(d),[s,c]=P.useState(j),x=Ie();v.useEffect(()=>{m(d),c(j)},[d,j]);const S=i.filter(a=>a.filter),T=Object.values(g).filter(a=>a&&typeof a=="string"&&a.length>0).length,A=a=>{S.forEach(B=>{b(B.id,"")}),a&&S.length>0&&b(S[0].id,a)},I=a=>{const B=a.target.value;p(B),A(B)},z=()=>{p(""),A("")},O=a=>{u===a?c(s==="asc"?"desc":"asc"):(m(a),c("asc"))},E=()=>{(u!==d||s!==j)&&w(u),r(!1)},k=()=>{const a=i[0];m(a.id),c("asc")},M=()=>{m(d),c(j),r(!1)};return e.jsxs(f,{sx:{mb:2},children:[e.jsxs(U,{elevation:0,sx:{p:1,mb:1.5,display:"flex",border:"1px solid",borderColor:"divider",borderRadius:1},children:[e.jsx(re,{placeholder:"Search all columns...",fullWidth:!0,size:"small",value:h,onChange:I,variant:"standard",InputProps:{startAdornment:e.jsx(se,{position:"start",children:e.jsx(je,{fontSize:"small"})}),endAdornment:h?e.jsx(se,{position:"end",children:e.jsx(W,{edge:"end",onClick:z,size:"small",children:e.jsx(ge,{fontSize:"small"})})}):null,disableUnderline:!0}}),e.jsx(W,{size:"small",onClick:()=>r(!0),sx:{ml:1},"aria-label":"Sort options",children:e.jsx(be,{})})]}),T>0&&e.jsxs(f,{sx:{mb:1.5,display:"flex",alignItems:"center"},children:[e.jsxs(D,{variant:"body2",color:"text.secondary",sx:{fontSize:12},children:['Showing results for "',h,'"']}),e.jsx(me,{label:"Clear",size:"small",variant:"outlined",sx:{ml:1,height:20,fontSize:11},onClick:z})]}),e.jsxs(Ce,{anchor:"bottom",open:C,onClose:M,onOpen:()=>r(!0),disableSwipeToOpen:!0,sx:{"& .MuiDrawer-paper":{borderTopLeftRadius:16,borderTopRightRadius:16,paddingBottom:x.bottom,maxHeight:"80vh"}},transitionDuration:300,children:[e.jsx(f,{sx:{width:"100%",display:"flex",justifyContent:"center",pt:1,pb:.5,cursor:"grab"},children:e.jsx(Se,{sx:{color:"text.disabled"}})}),e.jsx(f,{sx:{px:2,py:1},children:e.jsx(D,{variant:"h6",component:"h2",children:"Sort By"})}),e.jsx(K,{}),e.jsx(f,{sx:{px:2,py:2,flexGrow:1,overflow:"auto"},children:e.jsx(ne,{container:!0,spacing:1.5,children:i.map(a=>e.jsx(ne,{item:!0,xs:12,children:e.jsx(q,{fullWidth:!0,variant:u===a.id?"contained":"outlined",onClick:()=>O(a.id),endIcon:u===a.id?s==="asc"?"↑":"↓":null,sx:{justifyContent:"space-between",minHeight:48,textTransform:"none"},children:a.label})},String(a.id)))})}),e.jsx(K,{}),e.jsxs(f,{sx:{px:2,py:2,display:"flex",gap:1,justifyContent:"space-between"},children:[e.jsx(q,{onClick:k,variant:"outlined",color:"inherit",sx:{flex:1,minHeight:48},children:"Clear"}),e.jsx(q,{onClick:E,variant:"contained",color:"primary",sx:{flex:1,minHeight:48},children:"Apply"})]})]}),T===0&&e.jsx(D,{variant:"body2",color:"text.secondary",children:'No filters are currently applied. Click "Add Filter" to filter the data.'})]})}function He({columns:l,data:i,defaultSortColumn:d,defaultSortDirection:j,onRowClick:g,rowsPerPageOptions:w=[10,25,50],defaultRowsPerPage:b=10,id:C="data-table",enableSelection:r=!1,selected:h=[],onSelect:p,onSelectAll:u,getRowId:m,renderCollapse:s}){const c=m||(t=>t.id);r&&!m&&console.warn("getRowId should be provided when enableSelection is true. Falling back to assuming row.id exists.");const x=ye(),S=ve(x.breakpoints.down("sm")),[T,A]=v.useState(d),[I,z]=v.useState(j),[O,E]=v.useState(0),[k,M]=v.useState(S?Math.min(5,b):b),[a,B]=v.useState({}),[de,ce]=v.useState({}),xe=(t,n)=>{ce(o=>({...o,[t]:n}))};v.useEffect(()=>{S&&k>5&&M(5)},[S,k]);const $=t=>{z(T===t&&I==="asc"?"desc":"asc"),A(t)},Q=(t,n)=>{E(n)},Y=t=>{M(parseInt(t.target.value,10)),E(0)},Z=(t,n)=>{B(o=>({...o,[t]:n})),E(0)},V=(t,n)=>n.split(".").reduce((o,y)=>{if(o&&typeof o=="object")return o[y]},t),_=(t,n)=>{if(t===n)return 0;if(t==null)return-1;if(n==null)return 1;if(t instanceof Date&&n instanceof Date)return t.getTime()-n.getTime();const o=t,y=n;return typeof o==typeof y?o<y?-1:1:String(t).localeCompare(String(n))},H=v.useMemo(()=>[...i.filter(n=>Object.entries(a).every(([o,y])=>{if(!y)return!0;const R=l.find(te=>te.id===o);if(R!=null&&R.filterValue)return R.filterValue(n).toLowerCase().includes(y.toLowerCase());const pe=V(n,o);return String(pe).toLowerCase().includes(y.toLowerCase())}))].sort((n,o)=>{const y=V(n,T),R=V(o,T);return I==="desc"?_(R,y):_(y,R)}),[i,I,T,a,l]),L=v.useMemo(()=>{const t=O*k;return H.slice(t,t+k)},[H,O,k]),J=P.useMemo(()=>r?L.map(c):[],[L,r,c]),X=(t,n)=>{p&&p(t,n)},he=t=>{u&&u(t,J)},ee=t=>r?h.includes(c(t)):!1;return S?e.jsxs(f,{sx:{width:"100%"},children:[e.jsx(Ee,{columns:l,orderBy:T,order:I,filters:a,onRequestSort:$,onFilterChange:Z}),e.jsx(we,{spacing:1,children:L.map((t,n)=>e.jsx(Fe,{row:t,columns:l,selectable:r,selected:ee(t),onSelect:X,idField:m?void 0:"id",onRowClick:g?o=>g(o):void 0},n))}),e.jsx(ae,{rowsPerPageOptions:[5,10],component:"div",count:H.length,rowsPerPage:k,page:O,onPageChange:Q,onRowsPerPageChange:Y,sx:{".MuiTablePagination-selectLabel":{display:{xs:"none",sm:"block"}},".MuiTablePagination-displayedRows":{margin:"0 auto"}}})]}):e.jsxs(f,{sx:{width:"100%"},children:[e.jsx(Te,{component:U,children:e.jsxs(ke,{id:C,sx:{tableLayout:"fixed"},children:[e.jsx(De,{columns:l,orderBy:T,order:I,onRequestSort:$,filters:a,onFilterChange:Z,enableSelection:r,selected:h,onSelectAll:he,visibleRowIds:J}),e.jsx(Pe,{children:L.map((t,n)=>e.jsx(Be,{row:t,columns:l,index:n,onClick:g,enableSelection:r,selected:ee(t),onSelect:X,rowId:r?c(t):void 0,renderCollapse:s,isExpanded:!!de[c(t)],onExpand:o=>xe(c(t),o)},r?c(t):n))})]})}),e.jsx(ae,{rowsPerPageOptions:w,component:"div",count:H.length,rowsPerPage:k,page:O,onPageChange:Q,onRowsPerPageChange:Y})]})}export{He as D};
